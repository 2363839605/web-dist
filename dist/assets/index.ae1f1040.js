import{b as U,aW as z,bD as _,c as $,_ as O,bE as G,f as B,a1 as I,d as V,bF as n,a3 as u,bG as C,bH as N,n as Q,ah as q,aD as F}from"./index.739d1244.js";const J=(o,...r)=>{},R=new Map,Y=(o,r=window.scrollY)=>{R.set(o,r)},A=o=>{window.scroll({top:R.get(o)||0,behavior:"smooth"}),J("recoverScroll",o,R.get(o))};let D=!0,b,v;function K(o,r,i="replaceState"){let a=i==="location"?location.href:location.hash;if(!a.includes("?"))a=`${a}?${o}=${r}`;else if(!a.includes(o))a=`${a}&${o}=${r}`;else{const h=`(\\?|&|#)${o}([^&|^#]*)(&|$|#)`;a=a.replace(new RegExp(h),"$1"+o+"="+r+"$3")}i==="location"&&(location.href=a),i==="pushState"&&history.pushState({},"",a),i==="replaceState"&&history.replaceState({},"",a)}function E(o){for(var r=window.location.search.substring(1),i=r.split("&"),a=0;a<i.length;a++){var h=i[a].split("=");if(h[0]==o)return h[1]}return""}const g={};let l=1;const x=()=>l,X=()=>{const o=G();l=1,o.type==="pagination"&&K("page",1),console.log("resetGlobalPage",l)},k=()=>{const{pathname:o,to:r}=U(),[,i]=z(e=>_(e,O(),new $.CancelToken(t=>{b=t}))),a=G();a.type==="pagination"&&E("page")&&(l=parseInt(E("page")));const[,h]=z(e=>{const t={index:e==null?void 0:e.index,size:e==null?void 0:e.size};return B(e==null?void 0:e.path,O(),t.index,t.size,e==null?void 0:e.force,new $.CancelToken(s=>{v=s}))}),M=(e,t=!0,s=!1)=>{s&&(e=V(o(),e)),t?g[e]=!0:delete g[e]};let P=!1;const w=(e,t,s)=>(b==null||b(),v==null||v(),P=t!=null?t:!1,S(""),g[e]?m(e,l,void 0,void 0,s):W(e)),W=async e=>{n.setState(u.FetchingObj);const t=await i(e);C(t,s=>{var f;n.setObj(s),n.setProvider(s.provider),s.is_dir?(M(e),m(e,l)):(n.setReadme(s.readme),n.setHeader(s.header),n.setRelated((f=s.related)!=null?f:[]),n.setRawUrl(s.raw_url),n.setState(u.File))},S)},m=async(e,t,s,f=!1,L)=>{s||(s=a.size),s!==void 0&&a.type==="all"&&(s=void 0),l=t!=null?t:1,n.setState(f?u.FetchingMore:u.FetchingObjs);const T=await h({path:e,index:t,size:s,force:L});C(T,async c=>{var j;if(c.content!=null){for(const d of c.content)if(d.thumb!==""&&d.name.endsWith(".mp4"))try{const p=await _(e+"/.thumbnails/"+d.name+".webp");p.code===200?d.thumb=p.data.raw_url:d.thumb=""}catch(p){console.error("Error fetching thumbnail:",p)}}f?N(c.content):(n.setObjs((j=c.content)!=null?j:[]),n.setTotal(c.total)),n.setReadme(c.readme),n.setHeader(c.header),n.setWrite(c.write),n.setProvider(c.provider),n.setState(u.Folder),f&&(t!=null?t:1)>1||A(e)},S)},S=(e,t)=>{if(t===403)n.setState(u.NeedPassword),P&&Q.error(e);else{if(D&&e.endsWith("object not found")){D=!1,r(o().replace(q().base_path,""));return}(t===void 0||t>=0)&&n.setErr(e)}},y=(e,t,s=!1)=>m(o(),e,t,s),H=()=>y(l+1,void 0,!0);return{handlePathChange:w,setPathAs:M,refresh:async(e,t)=>{const s=o();if(Y(s),a.type==="load_more"||a.type==="auto_load_more"){const f=l;for(X(),await w(s,e,t);l<f;)await H()}else await w(s,e,t);A(s)},pageChange:y,loadMore:H,allLoaded:()=>l>=Math.ceil(I.total/a.size)}};function ee(o){return F({a:{viewBox:"0 0 24 24"},c:'<path fill="none" d="M0 0h24v24H0z"/><path d="M16 2l5 5v14.008a.993.993 0 01-.993.992H3.993A1 1 0 013 21.008V2.992C3 2.444 3.445 2 3.993 2H16zm-3 10h3l-4-4-4 4h3v4h2v-4z"/>'},o)}function te(o){return F({a:{viewBox:"0 0 24 24"},c:'<path fill="none" d="M0 0h24v24H0z"/><path d="M12.414 5H21a1 1 0 011 1v14a1 1 0 01-1 1H3a1 1 0 01-1-1V4a1 1 0 011-1h7.414l2 2zM13 13h3l-4-4-4 4h3v4h2v-4z"/>'},o)}function oe(o){return F({a:{viewBox:"0 0 24 24"},c:'<path fill="none" d="M0 0h24v24H0z"/><path d="M5.463 4.433A9.961 9.961 0 0112 2c5.523 0 10 4.477 10 10 0 2.136-.67 4.116-1.81 5.74L17 12h3A8 8 0 006.46 6.228l-.997-1.795zm13.074 15.134A9.961 9.961 0 0112 22C6.477 22 2 17.523 2 12c0-2.136.67-4.116 1.81-5.74L7 12H4a8 8 0 0013.54 5.772l.997 1.795z"/>'},o)}export{oe as R,X as a,A as b,te as c,ee as d,K as e,x as g,Y as r,k as u};
